<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NOPLP - REGIE FINALE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body class="bg-gray-900 text-white flex h-screen overflow-hidden">
    <!-- Library Modal -->
    <div
      id="lib-modal"
      class="hidden fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center"
      role="dialog"
      aria-labelledby="lib-modal-title"
      aria-modal="true"
    >
      <div
        class="bg-gray-800 border-2 border-yellow-400 p-6 w-4/5 max-h-[80vh] overflow-y-auto rounded-lg"
      >
        <h2
          id="lib-modal-title"
          class="text-yellow-400 text-2xl font-bold mb-4"
        >
          MA BIBLIOTHÈQUE
        </h2>
        <input
          type="text"
          id="lib-search"
          placeholder="Rechercher par numéro, catégorie ou paroles..."
          oninput="filterLibrary(this.value)"
          class="w-full bg-black text-white border border-gray-600 p-3 mb-4 rounded focus:outline-none focus:border-blue-500"
          aria-label="Rechercher dans la bibliothèque"
        />
        <div class="overflow-x-auto">
          <table id="lib-table" class="w-full border-collapse" role="table">
            <thead>
              <tr class="border-b border-gray-600">
                <th class="p-3 text-left">N°</th>
                <th class="p-3 text-left">CATÉGORIE</th>
                <th class="p-3 text-left">PAROLES</th>
                <th class="p-3 text-left">ACTION</th>
              </tr>
            </thead>
            <tbody id="lib-body"></tbody>
          </table>
        </div>
        <div class="flex gap-2 mt-5">
          <button
            onclick="exportData()"
            class="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded transition-colors"
            aria-label="Exporter les données"
          >
            EXPORTER
          </button>
          <button
            onclick="importData()"
            class="flex-1 bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-2 px-4 rounded transition-colors"
            aria-label="Importer les données"
          >
            IMPORTER
          </button>
          <button
            onclick="closeLib()"
            class="flex-1 bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition-colors"
            aria-label="Fermer la bibliothèque"
          >
            FERMER
          </button>
        </div>
      </div>
    </div>

    <!-- Sidebar -->
    <div
      class="w-96 bg-gray-800 p-4 border-r-2 border-yellow-400 overflow-y-auto"
    >
      <!-- Section 1: Enregistrer un Chant -->
      <h3
        class="text-yellow-400 border-b border-gray-600 pb-2 mb-4 text-sm uppercase font-semibold"
      >
        1. Enregistrer un Chant
      </h3>
      <input
        type="text"
        id="in-num"
        placeholder="Numéro du chant (ex: 10)"
        class="w-full bg-black text-white border border-gray-600 p-3 mb-3 rounded focus:outline-none focus:border-blue-500"
        aria-label="Numéro du chant"
      />
      <select
        id="in-cat"
        class="w-full bg-black text-white border border-gray-600 p-3 mb-3 rounded focus:outline-none focus:border-blue-500"
        aria-label="Catégorie du chant"
      >
        <option>Réunions de Jeunes</option>
        <option>Louange et Adoration</option>
        <option>Réveil</option>
      </select>
      <textarea
        id="in-text"
        rows="5"
        placeholder="Collez les paroles ici..."
        class="w-full bg-black text-white border border-gray-600 p-3 mb-3 rounded focus:outline-none focus:border-blue-500 resize-none"
        aria-label="Paroles du chant"
      ></textarea>
      <button
        onclick="saveSong()"
        class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded mb-3 transition-colors"
        aria-label="Sauvegarder le chant dans la base de données"
      >
        SAUVEGARDER DANS LA BASE
      </button>
      <button
        onclick="openLib()"
        class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded mb-6 transition-colors"
        aria-label="Ouvrir la bibliothèque des chants"
      >
        VOIR TOUTE LA BIBLIO
      </button>

      <!-- Section 2: Mode Finale -->
      <h3
        class="text-yellow-400 border-b border-gray-600 pb-2 mb-4 text-sm uppercase font-semibold"
      >
        2. Mode Finale
      </h3>
      <button
        onclick="activateFinale()"
        class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-4 rounded mb-6 transition-colors"
        aria-label="Activer le mode finale - Afficher tous les pièges"
      >
        MODE TOUS LES PIÈGES
      </button>

      <!-- Section 3: Correction -->
      <h3
        class="text-yellow-400 border-b border-gray-600 pb-2 mb-4 text-sm uppercase font-semibold"
      >
        3. Correction
      </h3>
      <textarea
        id="in-compare"
        placeholder="Saisie dynamique..."
        class="w-full bg-black text-white border-2 border-blue-500 p-3 mb-3 rounded h-20 resize-none focus:outline-none"
        aria-label="Saisie pour comparaison avec les paroles"
      ></textarea>
      <button
        onclick="verifyNow()"
        class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 rounded mb-6 transition-colors"
        aria-label="Vérifier le score de correspondance"
      >
        VÉRIFIER LE SCORE
      </button>

      <!-- Section 4: Contrôles -->
      <h3
        class="text-yellow-400 border-b border-gray-600 pb-2 mb-4 text-sm uppercase font-semibold"
      >
        4. Contrôles
      </h3>
      <select
        id="sel-mode"
        onchange="updateView()"
        class="w-full bg-black text-white border border-gray-600 p-3 mb-3 rounded focus:outline-none focus:border-blue-500"
        aria-label="Nombre de lignes à afficher en projection"
      >
        <option value="1">1 Ligne</option>
        <option value="2">2 Lignes</option>
      </select>
      <button
        onclick="openProj()"
        class="w-full bg-yellow-400 hover:bg-yellow-500 text-black font-bold py-3 px-4 rounded mb-3 transition-colors"
        aria-label="Ouvrir la fenêtre de projection"
      >
        OUVRIR PROJECTION
      </button>
      <div class="flex gap-2">
        <button
          onclick="goPrev()"
          class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded transition-colors"
          aria-label="Ligne précédente"
        >
          PREC.
        </button>
        <button
          onclick="goNext()"
          class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-4 rounded transition-colors"
          aria-label="Ligne suivante"
        >
          SUIV.
        </button>
      </div>
    </div>

    <!-- Main Content Area -->
    <div
      class="flex-1 bg-gray-950 p-5 overflow-y-auto"
      id="lyrics-list"
      role="main"
      aria-label="Liste des paroles"
    >
      <h2 class="text-gray-600 text-center mt-24 text-2xl">CHARGEZ UN CHANT</h2>
    </div>

    <script src="script.js"></script>
    <script>
      // Initialize textarea event listener after DOM loads
      document.addEventListener("DOMContentLoaded", function () {
        const compareInput = document.getElementById("in-compare");
        if (compareInput) {
          compareInput.addEventListener("input", syncNow);
        }
      });
    </script>
  </body>
</html>
